# Симулятор нефтяного месторождения

Высокопроизводительный симулятор для моделирования многофазной фильтрации в пористой среде с использованием Python и PyTorch для ускорения на GPU.

## Цель

Создать open-source альтернативу коммерческим продуктам для гидродинамического моделирования, таким как Schlumberger ECLIPSE.

## Математическая модель

В основе симулятора лежит решение системы дифференциальных уравнений в частных производных, описывающих течение двух несжимаемых флюидов (нефти и воды) в пористой среде.

### Основные уравнения

1.  **Уравнение неразрывности (для каждой фазы `α`):**
    \[
    \phi \frac{\partial S_\alpha}{\partial t} + \nabla \cdot \vec{u}_\alpha = q_\alpha
    \]
    где:
    - \( \phi \) — пористость,
    - \( S_\alpha \) — насыщенность фазы \( \alpha \),
    - \( \vec{u}_\alpha \) — скорость фильтрации фазы \( \alpha \),
    - \( q_\alpha \) — источники/стоки (скважины).

2.  **Закон Дарси (для каждой фазы `α`):**
    \[
    \vec{u}_\alpha = - \frac{K k_{r\alpha}}{\mu_\alpha} (\nabla P - \rho_\alpha \vec{g})
    \]
    где:
    - \( K \) — абсолютная проницаемость,
    - \( k_{r\alpha} \) — относительная фазовая проницаемость (в текущей версии упрощенно принята равной 1),
    - \( \mu_\alpha \) — вязкость фазы,
    - \( P \) — давление,
    - \( \rho_\alpha \) — плотность фазы,
    - \( \vec{g} \) — ускорение свободного падения.

### Численная схема: IMPES

Для решения этой системы мы используем стандартный для индустрии метод **IMPES (Implicit Pressure, Explicit Saturation)**.

1.  **Неявное уравнение для давления:** На каждом временном шаге мы решаем уравнение для давления, полученное суммированием уравнений для обеих фаз. Все члены уравнения (потоки, сжимаемость) берутся на новом, неизвестном временном слое. Это приводит к большой системе линейных алгебраических уравнений (СЛАУ) вида:
    \[
    \mathbf{A} \mathbf{P}^{n+1} = \mathbf{Q}
    \]
    Решение этой системы неявным образом гарантирует устойчивость расчета по давлению даже при больших шагах по времени. В нашем симуляторе СЛАУ решается итерационным методом сопряженных градиентов (Conjugate Gradient).

2.  **Явное уравнение для насыщенности:** После нахождения поля давлений \( P^{n+1} \), мы вычисляем скорости потоков. Затем, используя эти скорости, мы явно находим насыщенность на новом временном слое:
    \[
    S_w^{n+1} = S_w^n - \frac{\Delta t}{\phi} \nabla \cdot \vec{u}_w(P^{n+1})
    \]
    Этот явный шаг прост в реализации и вычислительно эффективен. Для устойчивости расчета потоков используется схема "против потока" (upwind).

## План

1.  [x] Инициализация проекта
2.  [x] Модель пласта (Reservoir)
3.  [x] Свойства флюидов (Fluids)
4.  [x] Модель скважин (Wells)
5.  [x] Симулятор потока (Flow Simulation)
6.  [x] Визуализация
7.  [ ] **Дальнейшее развитие:**
    -   [ ] Учет относительных фазовых проницаемостей (ОФП)
    -   [ ] Векторизация и перенос вычислений на GPU
    -   [ ] Усложнение моделей скважин и граничных условий
