# –°–∏–º—É–ª—è—Ç–æ—Ä –Ω–µ—Ñ—Ç—è–Ω–æ–≥–æ –º–µ—Å—Ç–æ—Ä–æ–∂–¥–µ–Ω–∏—è –Ω–∞ Python –∏ PyTorch

<p align="center"><img src="src/imgs/oil-sim.png" alt="Oil Simulator" width="70%"></p>

GPU-—É—Å–∫–æ—Ä–µ–Ω–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä –¥–ª—è —Ç—Ä—ë—Ö—Ñ–∞–∑–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–Ω–µ—Ñ—Ç—å‚Äì–≤–æ–¥–∞‚Äì–≥–∞–∑) —Å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ AMG-—Ä–µ—à–∞—Ç–µ–ª–µ–º –¥–∞–≤–ª–µ–Ω–∏—è. –ü–æ–¥—Ö–æ–¥–∏—Ç –∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∏ –¥–ª—è —Ä–∞—Å—á—ë—Ç–æ–≤ –Ω–∞ –∫—Ä—É–ø–Ω—ã—Ö —Å–µ—Ç–∫–∞—Ö (—Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –Ω–∞ 1‚ÄØ000‚ÄØ000 —è—á–µ–µ–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–∞ –æ–¥–Ω–æ–π 24‚ÄØ–ì–ë GPU).

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- **–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞:** —Å—Ö–µ–º–∞ **IMPES** (–¥–∞–≤–ª–µ–Ω–∏–µ ‚Äî –∏–º–ø–ª–∏—Ü–∏—Ç–Ω–æ, –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç–∏ ‚Äî —è–≤–Ω–æ) —Å —É—á—ë—Ç–æ–º —Å–∂–∏–º–∞–µ–º–æ—Å—Ç–∏, –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏ –∏ –∫–∞–ø–∏–ª–ª—è—Ä–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è.
- **–†–µ—à–∞—Ç–µ–ª—å –¥–∞–≤–ª–µ–Ω–∏—è:** –ø–æ–ª–Ω–æ—Å—Ç—å—é GPU-—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π **Classical AMG (Ruge‚ÄìStuben)** –≤ float64, —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –º–∞—Ç—Ä–∏—Ü—ã –±–µ–∑ –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∏.
- **–§–∏–∑–∏–∫–∞ –ø–ª–∞—Å—Ç–∞:** PVT-—Ç–∞–±–ª–∏—Ü—ã, Stone II (—Ç—Ä—ë—Ö—Ñ–∞–∑–Ω—ã–µ –∫—Ä–∏–≤—ã–µ), –∞–Ω–∏–∑–æ—Ç—Ä–æ–ø–Ω–∞—è –ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–≤–∞–∂–∏–Ω —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ –¥–µ–±–∏—Ç—É.
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ `P·µÄ A P`, –≤–µ–∫—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ `P`, —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç ¬´mega¬ª-–∫–µ–π—Å (‚âà3.9‚ÄØ–º–∏–Ω –ø–µ—Ä–≤—ã–π —à–∞–≥, 20‚Äì30‚ÄØ—Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ).
- **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤, npz/VTK-—Ñ–∞–π–ª–æ–≤, –ª–æ–≥–æ–≤ AMG –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —à–∞–≥–∞–º.
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –ø–æ–¥—Ä–æ–±–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç (MkDocs Material + PDF) —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Ñ–∏–∑–∏–∫–∏, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å open-source –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º –≥–∏–¥—Ä–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º —Å–∏–º—É–ª—è—Ç–æ—Ä–∞–º.

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å

–ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ –∫–æ–Ω–µ—á–Ω—ã—Ö –æ–±—ä—ë–º–æ–≤ –Ω–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π —Å–µ—Ç–∫–µ. –î–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—à–∞–µ–º –∏–∑ —Å–∏—Å—Ç–µ–º—ã `A p = b` (GMRES + AMG), –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —è–≤–Ω–æ. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ ‚Äî –≤ `docs/MATHEMATICS.md`.

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–í `results/<run_id>/` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:

1. –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è –∏ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç–µ–π (`*final.png`).
2. npz-—Ñ–∞–π–ª—ã —Å –ø–æ–ª—è–º–∏ (–¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏).
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) VTK-—Ñ–∞–π–ª—ã –¥–ª—è ParaView/VisIt.
4. –õ–æ–≥–∏ AMG –∏ —Å–≤–æ–¥–∫–∞ –ø–æ –¥–µ–±–∏—Ç–∞–º/–¥–∞–≤–ª–µ–Ω–∏—é.

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

- ‚úÖ AMG –ø—Ä–æ—Ö–æ–¥–∏—Ç self-check (`grad_rel < 5e-2`) –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç 3‚Äì6 V-—Ü–∏–∫–ª–æ–≤ –¥–æ `residual < 1e-3`.
- ‚úÖ ¬´Mega¬ª-–∫–µ–π—Å (`configs/mega_3phase_million.json`) –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–π 24‚ÄØ–ì–ë GPU.
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `mkdocs build` –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `site/pdf/OilSimulatorDocs.pdf`.
- ‚ö†Ô∏è –¢–µ–∫—É—â–∏–π –ø–æ—Ç–æ–ª–æ–∫ –±–µ–∑ –¥–æ–ø. –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π ‚Äî ~1‚Äì1.5‚ÄØ–º–ª–Ω —è—á–µ–µ–∫ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ VRAM). –í —Ä–∞–±–æ—Ç–µ: —Å–º–µ—à–∞–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ—ç—Ä—Å–Ω–∏–Ω–≥.
- üìà –í –ø–ª–∞–Ω–∞—Ö ‚Äî JFNK, –º–Ω–æ–≥–æ-GPU, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∏–∑–∏–∫–∏.

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã:

- `PHYSICS_MODELS.md` ‚Äî —Ñ–∏–∑–∏–∫–∞ –ø–ª–∞—Å—Ç–∞ –∏ —Ñ–ª—é–∏–¥–æ–≤.
- `MATHEMATICS.md` ‚Äî IMPES, AMG –∏ —á–∏—Å–ª–µ–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏.
- `ARCHITECTURE.md` ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–æ–¥–∞, –∫—ç—à AMG, –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö.
- `PERFORMANCE.md` ‚Äî –∑–∞–º–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø–ª–∞–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.
- `HOW_TO_GENERATE_PDF.md` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/researchim-ai/oil-simulator-py.git
cd oil-simulator-py
pip install -r requirements.txt
```

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ CUDA-—Å–±–æ—Ä–∫—É PyTorch, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∑–∞–ø—É—Å–∫ –Ω–∞ GPU.*

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

```bash
pip install -r requirements-docs.txt
playwright install chromium
```

## –ó–∞–ø—É—Å–∫ —Å–∏–º—É–ª—è—Ü–∏–∏

```bash
PYTHONPATH=src python src/main.py --config configs/medium_2d.json
```

–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç (1‚ÄØ000‚ÄØ000 —è—á–µ–µ–∫, —Ç—Ä—ë—Ö—Ñ–∞–∑–Ω—ã–π —Ä–µ–∂–∏–º, GPU):

```bash
PYTHONPATH=src python src/main.py --config configs/mega_3phase_million.json
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results/`.

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
pytest
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≥–æ–Ω—è—é—Ç –∫–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ AMG.

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

```bash
mkdocs build
python scripts/export_pdf.py
```

- HTML-–≤–µ—Ä—Å–∏—è: `site/index.html`
- PDF: `site/pdf/OilSimulatorDocs.pdf`

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ ‚Äî `docs/HOW_TO_GENERATE_PDF.md`.