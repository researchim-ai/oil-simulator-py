# –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø JFNK SOLVER

## ‚úÖ PHASE 1: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ò –ë–ê–ó–û–í–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (–ó–ê–í–ï–†–®–ï–ù–û!)
**–°—Ç–∞—Ç—É—Å: –í–´–ü–û–õ–ù–ï–ù–û ‚úÖ**
**–í—Ä–µ–º—è: ~2 —á–∞—Å–∞**

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:
1. ‚úÖ –°–æ–∑–¥–∞–Ω debug –∫–æ–Ω—Ñ–∏–≥ (configs/debug_small_2d.json) 
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ JVP vs finite differences
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ condition number 
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ø–∫–æ–±–∏–∞–Ω–∞
5. ‚úÖ **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:** –£–≤–µ–ª–∏—á–µ–Ω–∞ —Å–∂–∏–º–∞–µ–º–æ—Å—Ç—å —Ñ–ª—é–∏–¥–æ–≤ —Å 1e-4 –¥–æ 1e-2 1/–ú–ü–∞

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **P->P —Å–≤—è–∑—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞:** –±—ã–ª–æ 0.000e+00 ‚Üí —Å—Ç–∞–ª–æ 1.770e-02
- **Autograd —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:** —Å—Ö–æ–¥–∏—Ç—Å—è –∑–∞ 12 –∏—Ç–µ—Ä–∞—Ü–∏–π 
- **–°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–¥–≤–∏–≥–∞–µ—Ç—Å—è:** –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
- **–§–∏–∑–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞:** —Å–∏—Å—Ç–µ–º–∞ –±–æ–ª—å—à–µ –Ω–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ

---

## üîß PHASE 2: CORE NUMERICAL UPGRADE (CURRENT)
**–°—Ç–∞—Ç—É—Å:** üü° IN PROGRESS

–ú—ã –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –≤—Å—é —á–∏—Å–ª–µ–Ω–Ω—É—é —á–∞—Å—Ç—å –≤–º–µ—Å—Ç–æ ¬´–∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö¬ª —Ç–≤–∏–∫–æ–≤.

### –ù–æ–≤—ã–µ —Ü–µ–ª–∏
1. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –∞–≤—Ç–æ-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–±–µ–∑—Ä–∞–∑–º–µ—Ä–∏–∑–∞—Ü–∏—è).
2. CPR-FPF –ø—Ä–µ–¥–æ–±—É—Å–ª–∞–≤–ª–∏–≤–∞—Ç–µ–ª—å (Pressure-first + Fine/Coarse).
3. Jacobian-Free Newton‚ÄìKrylov —Å forcing-term Œ∑‚Çñ –∏ trust-region.
4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ float32 / mixed precision –Ω–∞ GPU.

### –ó–∞–¥–∞—á–∏
| ID | –ó–∞–¥–∞—á–∞ | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π | –°—Ç–∞—Ç—É—Å |
|----|--------|--------------|--------|
| 2-1 | –°–ª–æ–π `scale.py`: –ø–µ—Ä–µ–≤–æ–¥ P, S, q ‚Üí –±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω—ã—Ö, –æ–±—Ä–∞—Ç–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥ | ‚Äë | ‚è≥ |
| 2-2 | –í `jfnk.py`: –≤–Ω–µ–¥—Ä–∏—Ç—å forcing-term Œ∑‚Çñ (Brown‚ÄìSaad) | ‚Äë | ‚è≥ |
| 2-3 | Trust-region + backtracking line search | ‚Äë | ‚è≥ |
| 2-4 | `cpr.py`: —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CPR-FPF + BoomerAMG/AMGX backend | ‚Äë | ‚è≥ |
| 2-5 | E2E —Ç–µ—Å—Ç—ã: SPE1, SPE10(¬º)  ‚Üí < 12 Newton –∏—Ç–µ—Ä–∞—Ü–∏–π | QA | ‚è≥ |

### –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
‚Ä¢ 50 k —è—á–µ–µ–∫ –Ω–∞ GPU = < 3 s/—à–∞–≥, GMRES ‚â§ 30 –∏—Ç., Newton ‚â§ 10.

### 2025-07-06 ‚Äî *Progress update*
‚Ä¢ ‚úÖ CPR-FPF –ø—Ä–µ–¥–æ–±—É—Å–ª–∞–≤–ª–∏–≤–∞—Ç–µ–ª—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –∏ –ø—Ä–æ—à—ë–ª 1 M-cell GPU —Ç–µ—Å—Ç (‚â§100 –∏—Ç. AMG)
‚Ä¢ ‚úÖ –ë–∞–∑–æ–≤—ã–π —Å–ª–æ–π –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á—ë–Ω (pressure ‚Üí MPa, saturation ‚Üí rel).
‚Ä¢ ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: ‚àÜSw-–∫–∞—Ä—Ç—ã —Å –∫–æ–Ω—Ç—É—Ä–æ–º —Ñ—Ä–æ–Ω—Ç–∞, –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —è—á–µ–π–∫–∏.
‚Ä¢ üöß –ò–¥—ë—Ç –±–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥ –º–µ–≥–∞—Å–µ—Ç–∫–∏ (200 √ó 200 √ó 25) ‚Äî BoomerAMG/PETSc.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ near-term –∑–∞–¥–∞—á–∏ (Phase 2b)
| ID | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|----|--------|--------|
| 2-6 | IMPES large-scale benchmark (industrial_3d, mega_3d) –∏ –ø–æ–¥–±–æ—Ä CFL-safe dt | ‚è≥ |
| 2-7 | Black-Oil extension: –≥–∞–∑–æ–≤–∞—è —Ñ–∞–∑–∞ + —Ä–∞—Å—Ç–≤–æ—Ä—ë–Ω–Ω—ã–π –≥–∞–∑ (R\_s) | ‚è≥ |
| 2-8 | PETSc/HYPRE tuning: `restart=60`, adaptive `linear_tol` | ‚è≥ |
| 2-9 | AMGX backend (open-source) ‚Äî —Å–±–æ—Ä–∫–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ | ‚è≥ |
| 2-10| Real-time PNG/VTK writer –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π I/O) | ‚è≥ |
| 2-11| –ü—Ä–æ—Ñ–∞–π–ª–µ—Ä `tools/profile_run.py` + –∑–∞–ø–∏—Å—å –º–µ—Ç—Ä–∏–∫ –≤ docs/performance.md | ‚è≥ |

---

## üìà PHASE 3: LARGE-SCALE VALIDATION (NEXT)
  *100 k ‚Äì 5 M —è—á–µ–µ–∫*
1. –ë–µ–Ω—á–º–∞—Ä–∫–∏ SPE10-full –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–æ–¥–µ–ª–∏.
2. Mixed-precision CSR + matrix-free JFNK.
3. –•—Ä–∞–Ω–µ–Ω–∏–µ pressure-block –≤ Float16 (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç).
4. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∫–∏ –∏ telemetry-–ª–æ–≥ (GPU utilisation, memory).

---

## üöÄ PHASE 4: EXTREME SCALE & MULTI-GPU (FUTURE)
  *5 M ‚Äì 50 M —è—á–µ–µ–∫*
1. Domain decomposition (parMETIS) + NVSHMEM.
2. Multi-GPU AMG (Aggressive Coarsening, Fused SpMV).
3. Out-of-core restart + HDF5 / ADIOS I/O.
4. CI-pipeline –Ω–∞ AWS GPU p4d.

---

## üìú CHANGELOG

### 2025-01-04 ‚Äî **Phase 2 restarted**
* –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω –Ω–æ–≤—ã–π ¬´—Ç—Ä—ë—Ö-–æ–ø–æ—Ä–Ω—ã–π¬ª –ø–ª–∞–Ω (scaling + CPR-FPF + adaptive JFNK).
* –û—Ç–º–µ—á–µ–Ω —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–ø–∏—Å–æ–∫ –º–∏–∫—Ä–æ—Ç–≤–∏–∫–æ–≤, –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–¥–∞—á–∏.

### 2025-01-04 ‚Äî **Phase 1 complete**
* –§–∏–∑–∏—á–µ—Å–∫–∞—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ (cf ‚Üë).